# The apsim netlify site

Most apsim nextgen documentation is hosted on a [netlify site](https://apsimnextgeneration.netlify.com). The site is updated automatically by [jenkins](jenkins.md) whenever a new release of apsim is created. There are two parts to the website - the static documents and the auto-generated documentation (autodocs).

The static content is generated from markdown files in the [apsim repository](https://github.com/APSIMInitiative/ApsimX/tree/master/Docs). The autodocs are generated by [jenkins](jenkins.md) when a pull request is tested, and are uploaded to the builds API. The autodocs page on the netlify site contains an iframe which connects to the autodocs REST API, which returns the latest version of the autodocs. A more efficient method might be to output the autodocs in markdown format, and inject them into the website's content when we deploy the site.

## Local (debug) builds

It's possible to run a local "debug" version of the site by using the [hugo](https://gohugo.io/) tool. Simply install the tool, run `hugo serve` from the ApsimX/Docs/ directory, and navigate to the specified address (default `localhost:1313`) in a web browser. This is useful for testing changes to the website before deploying them via a PR.

## Autodocs

The autodocs are generated by a .net console application called APSIM.Documentation. The source code for this app is stored in the [apsim repo](https://github.com/APSIMInitiative/ApsimX/tree/master/APSIM.Documentation).

The document configuration (ie which files get documented) is all hardcoded in Program.cs. Therefore, in order to include a new file in the autodocs, you'll need to modify the code. In the long run it might be better to store the configuration in a config file (e.g. yaml, json, ...). However there are different methods of documentation which can be used, some of the files need to be documented differently, and there are plenty of special cases, all of which would need to somehow be resolved by this config file.

## Deploying to production

The [apsim release](jenkins.md) build will automatically update the netlify website. This is done by calling a POST endpoint in the [netlify API](https://open-api.netlify.com/) and passing in our build hook (an auth token).
